<%- include("../admin/layouts/adminHeader.ejs") %>

<style>


/* 
  .form-style {
    width: 550px;
    height: 42px;
    background-color: rgb(255, 255, 255);
    border: 1px solid #ccc;
    border-radius: 5px;
    margin-left: 15px;
    padding-left: 10px;

    
  } */

  .image-preview-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px; /* Add some spacing between previews */
  }

  .image-preview {
      max-width: 200px;
      max-height: 200px;
      position: relative;
  }

  .image-preview img {
      max-width: 100%;
      max-height: 100%;
      object-fit: cover;
  }

  .remove-button {
      display: none;
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #ff5c5c;
      border: none;
      color: white;
      cursor: pointer;
      padding: 5px 10px;
      font-size: 14px;
      border-radius: 4px;
  }

  .image-preview:hover .remove-button {
      display: block;
  }


 
  
</style>

<body class="g-sidenav-show bg-gray-200">
  <%- include("../admin/layouts/adminSideBar.ejs") %>
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
    <!-- Navbar -->
    <%- include("../admin/layouts/adminNavBar.ejs") %>
    <!-- End Navbar -->
    <div class="container-fluid py-4">
      <div class="row">
        <div class="col-12 elemDesign">
          <div class="card my-4 col-12">
            <div class="card-header p-0 position-relative mt-n4 mx-3 z-index-2 elemDesign2">
              <div class="bg-gradient-primary shadow-primary border-radius-lg pt-4 pb-3">
                <h6 class="text-white text-capitalize ps-3">ADD PRODUCT</h6>
              </div>
            </div>
            <div class="card-body px-0 pb-2">
              <form class="forms-sample p-3" action="/admin/addproduct" method="post" enctype="multipart/form-data" style="background-color: #ffffff;" id="productForm">
            
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="productName" class="font-weight-bold pl-3" style="color: #000000;">Product Name</label>
                      <input type="text" class="form-control " name="productName" id="productName" placeholder="Name">
                      <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="price" class="font-weight-bold pl-3" style="color: #080000;">Price</label>
                      <input type="number" class="form-control form-style" id="price" name="price" placeholder="price">
                      <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                </div>
            
                <div class="row">
                  <div class="col-md-6 ">
                    <div class="form-group">
                      <label for="brand" class="font-weight-bold pl-3" style="color: #000000;">Brand</label>
                      <input type="text" class="form-control form-style" name="brand" id="brand" placeholder="brand">
                      <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label class="font-weight-bold pl-3" style="color: #000000;">Category</label>
                      <select name="category" class="form-control form-style">
                        <option selected>Select Category</option>
                        <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                        <% for(let i=0;i< cartData.length;i++){ %>
                        <option value="<%=cartData[i]._id%>">
                          <%= cartData[i].name %>
                        </option>
                        <% } %>
                      </select>
                    </div>
                  </div>
                </div>
            
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="status" class="font-weight-bold pl-3" style="color: #000000;">Status</label>
                      <input type="text" class="form-control form-style" id="status" name="status" placeholder="status">
                      <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label class="font-weight-bold pl-3" style="color: #000000;">Quantity</label>
                      <input type="number" class="form-control form-style" id="quantity" name="quantity" placeholder="Enter Stock">
                      <span class="error" style="color: red;  margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                </div>
            
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <label for="description" class="font-weight-bold pl-3" style="color: #000000;">Description</label>
                      <input name="description" class="form-control form-style" id="description" rows="4"></input>
                      <span class="error" style="color: red; margin-left: 15px; font-size: 10px;"></span>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <label class="upload__btn ms-3">
                        <p class="font-weight-bold pl-1" style="color: #000000;">Upload Images</p>
                        <input type="file" id="coverpic" name="image" multiple data-max_length="20" class="upload__inputfile" onchange="displaySelectedImages(this)">
                        <span class="error" style="color: red; margin-left: 15px; font-size: 10px;"></span>
                      </label>
                    </div>
                  </div>
                </div>
            
                <div class="image-preview-container mt-2"></div>
            
                <div class="d-flex justify-content-center"><button type="submit" class="btn btn-primary">Add Product</button></div>
              </form>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    

  </main>

  

  <script>
     document.addEventListener('DOMContentLoaded', function () {
    const coverPicInput = document.getElementById('coverpic'); // Fix the ID here
    const previewContainer = document.querySelector('.image-preview-container');

    coverPicInput.addEventListener('change', function () {
      previewContainer.innerHTML = '';

      Array.from(coverPicInput.files).forEach(function (file) {
        const reader = new FileReader();

        reader.onload = function () {
          const imagePreview = document.createElement('div');
          imagePreview.classList.add('image-preview');

          const image = document.createElement('img');
          image.src = reader.result;
          image.classList.add('img-fluid');

          const removeButton = document.createElement('button');
          removeButton.type = 'button';
          removeButton.classList.add('remove-button');
          removeButton.textContent = 'Remove';
          removeButton.addEventListener('click', function () {
            imagePreview.remove();
            // Remove corresponding file from input
            const dt = new DataTransfer();
            Array.from(coverPicInput.files).forEach(function (existingFile) {
              if (existingFile !== file) {
                dt.items.add(existingFile);
              }
            });
            coverPicInput.files = dt.files;
          });

          imagePreview.appendChild(image);
          imagePreview.appendChild(removeButton);
          previewContainer.appendChild(imagePreview);
        };

        reader.readAsDataURL(file);
      });
    });
  });
  </script>







    
      <%- include("../admin/layouts/adminFooter.ejs") %>